<div class="page" *ngIf="!loading && blog">
  <mat-card class="details-card">
    
    <div class="header-image-container">
      <img
        [src]="(blog.images && blog.images.length > 0) ? blog.images[0] : 'https://theroostingplace.blog/wp-content/uploads/2020/12/qi-bin-w4hbafegiac-unsplash.jpg'"
        alt="Blog header"
        class="header-img"
      />
      <div class="header-overlay"></div>
    </div>

    <div class="content-padding">
      <h1 class="blog-title">{{ blog.title }}</h1>
      
      <div class="meta-info">
        <div class="author-tag">
          <mat-icon>person</mat-icon>
          <span>Author: <b>@{{ blog.authorUsername || 'Unknown' }}</b></span>
        </div>
        <div class="date-tag">
          <mat-icon>calendar_today</mat-icon>
          <span>Published: {{ blog.createdAt | date: 'dd.MM.yyyy' }}</span>
        </div>
      </div>

      <mat-divider class="divider"></mat-divider>

      <div class="markdown-body">
        <markdown [data]="blog.descriptionMarkdown"></markdown>
      </div>

      <div class="gallery-section" *ngIf="blog.images && blog.images.length > 1">
        <h3 class="gallery-title">Gallery</h3>
        <div class="image-grid">
          <img *ngFor="let img of blog.images.slice(1)" [src]="img" class="gallery-img" />
        </div>
      </div>
      
      <div class="actions">
        <button mat-stroked-button color="primary" class="back-btn" [routerLink]="['/blogs']">
          <mat-icon>arrow_back</mat-icon> Back to Feed
        </button>
      </div>
    </div>
  </mat-card>
</div>

<div class="page-state" *ngIf="loading">
  <mat-spinner diameter="40"></mat-spinner>
  <p>Loading blog content...</p>
</div>

<div class="page-state" *ngIf="errorMsg">
  <p class="err-text">{{ errorMsg }}</p>
  <button mat-button color="primary" [routerLink]="['/blogs']">Go back</button>
</div>